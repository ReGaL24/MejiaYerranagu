\section{Specific Requirements}

\subsection{External Interface Requirements}
\subsubsection{User Interfaces}
The below show the mock ups of the mobile application User Interface. This sections outlines the user interface of the most important screens of the application from the POV of the user. The user experience changes quiet a bit depending on the user - if he/she is a registered one or not. 

\textbf{Sign-up and Login screen}

\begin{minipage}{0.5\textwidth}
\includegraphics[width=\linewidth]{Images/UI mockups/Sign In.png}
\end{minipage}
\hfill%
\begin{minipage}{0.4\textwidth}
Once the user opens the BBP app, they are greeted with this homepage, which offers the user to either login to an existing profile or sign-up and register as a new user or continue to the app as an unregistered user.
\end{minipage}

\newpage
\textbf{Home screens}

Once the user logins to the app, the home screen differs based on the type of user - a registered or an unregistered one. The two mock-ups emulating the two scenarios are shown below:

\begin{minipage}{0.5\textwidth}
\includegraphics[width=0.7\linewidth]{Images/UI mockups/Homepage - registered.png}
\end{minipage}
\hfill%
\begin{minipage}{0.4\textwidth}
\textbf{Registered User}\\
The registered users are greeted with the home screen on the left.
Based on the actions that a registered user can perform, the main home screen offers the user with 3 tab at the bottom - 
\begin{itemize}
    \item Trip tab to initiate a new trip recording.
    \item Routes tab to do a manual path query.
    \item Profile tab to look at past trips and account overviews and settings
\end{itemize}

\end{minipage}

\begin{minipage}{0.5\textwidth}
\includegraphics[width=0.7\linewidth]{Images/UI mockups/Unresgistered User.png}
\end{minipage}
\hfill%
\begin{minipage}{0.4\textwidth}
\textbf{Unregistered User}\\
An unregistered user's home screen on the other hand has access to just the Manual Path Query tab and an additional tab where the user can register an account if they wish to do so.
\end{minipage}


\newpage
\textbf{Trip Information}

\begin{minipage}{0.5\textwidth}
\includegraphics[width=0.7\linewidth]{Images/UI mockups/Trip in progress.png}
\end{minipage}
\hfill%
\begin{minipage}{0.4\textwidth}
This screen depicts a trip in progress. The screen show the user, the distance covered, the time elapsed and the instantaneous speed. The application also gives the user to report any obstacles present along the path. In addition to this, the system makes use of live notifications for automatic obstacle recognition. The notification shows up on the screen and stays on for 5 seconds for the user to accept and add it to the path. This is done so that false notifications can be ignored.
\end{minipage}

\begin{minipage}{0.5\textwidth}
\includegraphics[width=0.7\linewidth]{Images/UI mockups/Trip completion.png}
\end{minipage}
\hfill%
\begin{minipage}{0.4\textwidth}
Trip summary screen show the user the summary with the ride statistics computations along with the weather enrichment if present. The user has the option to either discard the trip or to save the trip and publish the path.
\end{minipage}


\newpage
\textbf{Manual Path Query}

\begin{minipage}{0.5\textwidth}
\includegraphics[width=\linewidth]{Images/UI mockups/Registered user path query.png}
\end{minipage}
\hfill%
\begin{minipage}{0.4\textwidth}
This Manual Path Query screen is essentially the same for both the users, offering them the option of manually searching the required path between origin-destination pair. The only additional UI element that the registered user has is the create path button, which allows the registered user to create paths manually. 
\end{minipage}

\newpage
\textbf{Account Overview}

\begin{minipage}{0.5\textwidth}
\includegraphics[width=\linewidth]{Images/UI mockups/Account - cards.png}
\end{minipage}
\hfill%
\begin{minipage}{0.4\textwidth}
The Account overview tab allows the registered users to see their past trip and its summaries by click on a particular trip. The account tab also houses the user banner which shows their profile picture along with the user information.
\end{minipage}


\includegraphics[scale = 0.5]{MejiaYerranagu/RASD/Images/UI mockups/Account- list.png}

\subsubsection{Hardware Interfaces}
The system relies a lot on personal devices that can be carried with the user that have the ability to record the change in GPS data, motion along with internet connectivity.

\textbf{GPS Module}

The GPS data for the system is mainly accessed via smartphone operating systems' GPS API
mainly 
\begin{itemize}
    \item CLLocationManager on iOS
    \item LocationManager on Android
\end{itemize}
An accuracy of $\pm 10$ meters and sampling rate of \(\geq 1\)Hz during active recording is expected. Metadata from the GPS such as latitude, longitude, altitude, accuracy and speed are used by the system to provide the user with ride statistics 

\textbf{Device Motion Sensor}

Standard smartphone motion sensor APIs are used to get information from the accelerometer to better detect the biking motion.

\textbf{Network Interfaces}

System uses internet connectivity through WiFi or cellular standards like 5G, 4G or LTE for processing of data. HTTPS is used for encrypted communications. the data transmission happens with the help of JSON payloads with gzip compression for large files.

\subsubsection{Software Interfaces}

\textbf{Weather Service API}

The system uses the Weather Service API to get the weather information for the location.
The weather service has a timeout set at 5 seconds after which the system retries to fetch the weather a max of 3 times with exponential back-offs in the background (1s, 2s, 4s). Failure to get the weather information before the timeout leads to a graceful fallback where the system completes the trip and saves it to the profile without weather information. A sample API request is shown below: 
\begin{verbatim}
Request:

GET https://api.openweathermap.org/data/2.5/weather
    ?lat={latitude}
    &lon={longitude}
    &appid={API_KEY}
    &units=metric
\end{verbatim}

\textbf{Geocoding Service Interface}

Similarly the system uses OpenStreetMap APIs or other equivalent for geocoding from both \(address \to coordinates\) and \(coordinates \to address\) during path querying. The geocoding service has a timeout of 10 seconds after which the system gives the user an error message saying the operation is taking longer than expected. In this case, the user has the option of entering raw coordinates for the query to go through.

\begin{verbatim}
Request (Forward Geocoding):

GET https://nominatim.openstreetmap.org/search
    ?q={address}
    &format=json
    &limit=1

    

Request (Reverse Geocoding):

GET https://nominatim.openstreetmap.org/reverse
    ?lat={latitude}
    &lon={longitude}
    &format=json
\end{verbatim}

\textbf{Mobile Device Sensor APIs}

The GPS data and the motion sensor data for the system are mainly accessed via smartphone operating systems' GPS and Device Sensor APIs

iOS:
\begin{itemize}
    \item CLLocationManager for GPS location and Heading
    \item CMMotionManager for accessing the data from accelerometer/gyroscope for activity detection.
\end{itemize}

Android:
\begin{itemize}
    \item FusedLocationProviderClient for GPS locations and Heading
    \item SensorManager for accessing data from the motion sensors
\end{itemize}

Both iOS and Andoid apps require permissions from the users to access these data.

\subsubsection{Communication Interfaces}

BBP application relies on its internet connectivity for a happy sail. The interactions on the app must be secure and encrypted using HTTPS/TLS Protocol. The platform also makes use of REST API for communicating with the server for the trip creations, path queries and route updates.


\subsection{Functional Requirements}

\subsubsection{Functional Requirements Specification}
\input{SubSections/3_2_1 Functional Requirements Specification}

\newpage
\subsubsection{Use Case Diagrams}
\bigskip
\includegraphics[width=\textwidth]{Images/UseCaseDiagram_1.png}

\bigskip
\includegraphics[width=\textwidth]{Images/UseCaseDiagram_2.png}

\newpage
\subsubsection{Use Cases}
\input{SubSections/3_2_3 Use Cases}

\newpage
\subsubsection{Sequence Diagrams}

\newpage
\subsubsection{Requirement mapping}
\input{SubSections/3_2_5 Requirement Mapping}


\subsection{Performance Requirements}

The main performance aspects of the system is its ability to get the synergy right with the different API calls, GPS and sensor data. Unavailability of non essential data should be dealt gracefully. Given that the system can have 1000's if not more concurrent at its peak, it is important that performance requirements are robust and should adhere to the said guideline with respect to timeouts. 

\textbf{Trip Recording Response Times}
\begin{itemize}
    \item When the Start button is pressed the system should secure a GPS lock in $\leq$ 2 seconds
    \item The GPS update rate should be $\geq $ 1 Hz and the real-time metrics should refresh $\leq$ 500 ms, no perceivable lag when metrics are updated on the screen.  
\end{itemize}

\textbf{Trip Processing and Weather Enrichment}
\begin{itemize}
    \item The trip should complete processing $\leq$ 10 seconds.
    \item A hard limit of 5 seconds is enforced for weather enrichment. This is negotiable as the trip can be saved even without weather in case the service times-out.
\end{itemize}

\textbf{Route Query Response}
\begin{itemize}
    \item Origin - destination query should yield results within 3 seconds of the query.
    \item Geocoding should yield desired results in $\leq$ 5 seconds along with PathScore computation of $\leq$ 0.5 seconds for paths viewable on the screen.
    \item All in all, the worst case scenario should give an output to the user in under 10 seconds.
\end{itemize}

\textbf{Map Visualization Performance}
\begin{itemize}
    \item Maps with paths rendered should support a frame-rate of $\geq$ 30 FPS on a mid range smartphone.
    \item Pan/Zoom operations should be responsive ($<$ 200 ms latency)
\end{itemize}

\textbf{Trip Upload Performance}
\begin{itemize}
    \item GPS tracking data should be uploaded in $\leq$ 5 seconds (20 minute trip $\to$ 3 MB data).
    \item $gzip$ is used when necessary to achieve $60-80 \%$ reduction in size.
\end{itemize}

\textbf{Performance efficiency}
\begin{itemize}
    \item The system shall support $\geq$ 5000 concurrent active users without performance degradation.
    \item Trip data should be around 2 MB including all the GPS tracking, stats, metadata.
    \item Historical data $>$30 days should be compressed via archival.
\end{itemize}

\textbf{Battery Consumption}
\begin{itemize}
    \item Trip recording with the continuous use of GPS, Motion sensors and the screen should be $\leq$ 8 \% battery per hour on a typical mid-range smartphone with 3000mAh battery.
    \item Idle state should result in minimal battery drain of around $<$1\% per hour.
\end{itemize}

% -----------------------------------------------------------------------------------------

\subsection{Design Constraints}

\subsubsection{Standard Compliance}

\textbf{Security and Conformity Standards}
\begin{itemize}
    \item TLS 1.2+ for all HTTPS communications.
    \item The system must be compliant with General Data Protection Regulation in accordance with the European Guidelines.
    \item The Password should be a minimum of 8 characters with good complexity - Uppercase, Lowercase, Number, Special characters.
    \item Should prevent SQL injections and have XSS protection.
    \item The system shall posses OAuth 2.0 or equivalent for authentication.
\end{itemize}

\textbf{Data Format Standards}
\begin{itemize}
    \item Geographical coordinates should follow WGS 84 - latitudes and longitudes in decimal degrees.
    \item Timestamps are to be in ISO 8601 format with timezones. Eg."2025-12-09T14:30:45Z"
    \item Distance should be in either Metric or Imperial based on users settings.
\end{itemize}

\subsubsection{Hardware Limitations}

\textbf{Mobile device limitations}
\begin{itemize}
    \item OS : iOS 14+ / Android 10+
    \item Minimum Storage : 100 MB free space (app and local buffering)
    \item Minimum RAM : 2 GB (Optimal $\geq$ 4 GB)
    \item GPS Hardware : Standard smartphone GPS
    \item Motion Sensors: Standard Motion Sensor suit
\end{itemize}

\textbf{Network Limitations}
\begin{itemize}
    \item Minimum Bandwidth of 1 Mbps upload and download.
    \item The system tolerates around 20 seconds of roundtrip delays without user facing timeout.
    \item Trip data is buffered locally for $\leq$ 48 hours. Sync is established upon reconnection.
\end{itemize}

\textbf{Database and Storage}
\begin{itemize}
    \item Estimated daily volume with around 10,000 users is around 150 GB raw trip data
    \item Estimated 1 year storage is around 55 TB, database can be shard by geographic region for scalability
\end{itemize}

\subsubsection{Other Design Constraints}

\textbf{Third-Party Service Dependencies}
\begin{itemize}
    \item Weather services like OpenWeather API or Equivalent are used with < 5 seconds response time.
    \item OpenStreetMap or Google Maps API are used for maps and geocoding
\end{itemize}

\textbf{Data Retention and Privacy}
\begin{itemize}
    \item Trip data is retained for 5 years after which it is deleted per GDPR data minimization guidelines.
    \item Path information is retained indefinitely as its deemed a community asset.
    \item User profiles are retained for the account lifetime. Should the user request to delete the account, the user profile data is wiped after 180 days.
    \item GPS tacking is not published, only the path status and obstacles are made public.
\end{itemize}

\textbf{Platform Architecture}
\begin{itemize}
    \item The backend is divided into microservices like Trip Service, Path Service, Weather Service, Notification Service enabling for independent scaling when in need.
    \item Frontend is native mobile development aided by web based query interface.
    \item Database powered by PostgreSQL.
\end{itemize}


% -----------------------------------------------------------------------------------------

\subsection{Software System Attributes}

\subsubsection{Reliability}
\textbf{Trip Data Integrity}
\begin{itemize}
    \item The trip data shall never be lost except in times of detrimental device failure
    \item The trip data should remain locally on device momentarily after trip completion and cloud synchronization should be carried out within 2 attempts.
    \item In case of timeouts, the recovery system will retry with uploading the trip data automatically and this shall require no user intervention unless there is persistent network issues.
\end{itemize}

\textbf{Weather Enrichment Robustness}
\begin{itemize}
    \item Failure in acquiring weather enrichment will never cause a trip rejection.
    \item In case when the weather enrichment fails, the trip will be recorded without the weather data and the weather fields in the trip summary are marked "unavailable".
    \item Should the weather enrichment service fail, the system provides the user with the option of fetching the weather information within 48 hours port trip submission via a manual "Retry"
    option.
\end{itemize}

\textbf{Data Consistency}
\begin{itemize}
    \item A trip once submitted to the system is un-editable.
    \item Paths once published cannot be edited or deleted.
    \item GPS lock on the device should be continuous and should be within tolerance of $<$ 5 seconds. If at all metadata for GPS includes larger gaps, the system will flag the metadata.
\end{itemize}

\subsubsection{Availability}
The system shall maintain an average operational state of $\geq 99.0\%$ with a maximum scheduled maintenance of 2 hrs/month during low traffic window (1:00 - 2:00 GMT). Critical services such as User authentication, Trip storage and Path queries are to replicated across 2 or more geographic locations to aid in automatic fail-over in case the primary system fails. Caching to be used in case the route computation times-out, so that results from previous queries are displayed offering the user to retry. Graceful degradation is offered with the weather service and geocoding services where trip can be saved without weather enrichment for the former and with user entering raw coordinates for the later.

\subsubsection{Security}
The system shall use OAuth 2.0 token based system where users can authenticate via Google, Apple or with Emails and passwords. Personal data like emails, GPS traces are encrypted using AES-156 encryption standard, while passwords use \verb|bcrypt| hashing and at last HTTPS with TLS 1.2+ is used for communication. Threat mitigation has been provided against SQL injection, XSS and CSRF attacks. Further, a limit of 100 request per minute per IP, a max file upload limit of 100MB and a query timeout of 30 sec is put in place for protection against DoS attacks and for reliability of the system.

\subsubsection{Maintainability}
The system should be readable, maintainable and be fully documented. Microservice architecture to be used to ensure modular design principles with acceptable linear independent paths and unit tests. the services are to be designed such that they are scalable, maintainable and testable. Runbooks are used for starting, stopping, debugging and for common troubleshooting. Migrations are ought to be tested in QA or staging environment before the applying them too production databases.

\subsubsection{Portability}
Since the system mainly runs on smartphones, the mobile platform should be equipped with iOS 14+ (iPhone 8 +) or Android 10+ (2GB+ RAM devices.) sporting a responsive design of 320px for ease of use on handhelds. The system shall have no proprietary dependencies ensuring usage of public data sources.