\section{Formal Analysis using Alloy}

For the formal analysis of the BestBikePath system, we utilized the Alloy modeling language and the Alloy Analyzer tool. The BestBikePath system was essentially broken into two modules :
\begin{itemize}
    \item Trip Recording System
    \item Path Publication System
\end{itemize}
for easier understanding and modeling. Each module was modeled separately along with relevant signatures, facts, assertions and predicates to capture the system's behavior and constraints.
%------------------------------------------------------------------------------------

% alloy - model for bbp trip recording system 

\textbf{BestBikePath Trip Recording:}

The BestBikePath (BBP) Trip Recording system is designed to record and manage bike trips for users. The system captures essential trip details, including start and end locations, timestamps, and other trip information. The primary goal is to ensure accurate trip recording while maintaining data integrity and user distinguishability.
\lstinputlisting[language= Alloy]{Sections/Alloy/bbp_trip_recording.als}

\lstinputlisting[
    language= Alloy,
    firstline=5, 
    lastline=127
]{Sections/Alloy/bbp_trip_recording.als}

\textbf{Result:}

The following figure shows the result of running the above assertions of the Alloy model in the Alloy Analyzer. It shows that the assertions we defined hold true.

\includegraphics[scale = 0.8]{Images/Alloy/bbp_trip_recording_results.png}
\newpage

\textbf{BestBikePath Path Publication:}

The second model focuses on the rules governing the review, publication, and visibility of bike path information contributed by users. These rules capture system-wide constraints that determine how information becomes accessible to other users.

\lstinputlisting[
    language= Alloy,
    firstline=6, 
    lastline=69,
]{Sections/Alloy/bbp_path_publication.als}

\textbf{Result:}

The following assertions validate the core constraints governing review and publication of path information, ensuring that unsafe or unreviewed data cannot be publicly exposed.

\lstinputlisting[
    language= Alloy,
    firstline=70, 
    lastline=113,
]{Sections/Alloy/bbp_path_publication.als}

\includegraphics[width=0.95\textwidth]{Images/Alloy/bbp_path_publication_results.png}

As we can see in the following examples, the three predicates defined in the model demonstrate the intended behavior of the BestBikePath Path Publication system, in which only safe and reviewed paths are made public, and unregistered users cannot contribute path information.

In this first example, the configuration includes a path information object created in manual mode that is marked as reviewed and set to public visibility (\verb|PathInformation5|). This instance represents a successfully reviewed and published path, as described in UC7. At the same time, the figure shows examples of other objects which still represent valid system states that coexist with the published path, demonstrating that the model allows for a variety of states while enforcing the publication rules.

\lstinputlisting[
    language= Alloy,
    firstline=117, 
    lastline=124, 
]{Sections/Alloy/bbp_path_publication.als}

\includegraphics[width=\textwidth]{Images/Alloy/bbp_path_publication_example_1.png}


Similarly, in the next example, the configuration includes a path information object created in automatic mode that is marked as unreviewed and kept private (\verb|PathInformation5|). This instance represents the system state immediately after automatic data acquisition and before user confirmation, as described in UC8.

\lstinputlisting[
    language= Alloy,
    firstline=126, 
    lastline=133, 
]{Sections/Alloy/bbp_path_publication.als}

\includegraphics[width=\textwidth]{Images/Alloy/bbp_path_publication_example_2.png}


Finally, in the last example, we extend the previous analyses by focusing on information visibility, showing that unreviewed automatic contributions remain private and accessible only to their registered owner.

\lstinputlisting[
    language= Alloy,
    firstline=135, 
    lastline=145, 
]{Sections/Alloy/bbp_path_publication.als}

\includegraphics[width=\textwidth]{Images/Alloy/bbp_path_publication_example_3.png}
